<!DOCTYPE html>
<html lang="vi">

<head>
    <!-- Security: Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; 
                   script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://unpkg.com https://www.googletagmanager.com https://www.google-analytics.com; 
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                   font-src 'self' https://fonts.gstatic.com; 
                   img-src 'self' data: https: blob:; 
                   connect-src 'self' https://api.counterapi.dev https://www.google-analytics.com;">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MN222YF1D7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-MN222YF1D7');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Cổng Thông Tin Tuyên Truyền Pháp Luật | Công An Tỉnh Phú Thọ</title>
    <meta name="description"
        content="Cổng thông tin tuyên truyền, phổ biến pháp luật về xuất nhập cảnh, cư trú của người nước ngoài tại Việt Nam.">

    <!-- PWA & SEO -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#D00000">
    <meta property="og:title" content="Tuyên Truyền Pháp Luật - Công An Phú Thọ">
    <meta property="og:description"
        content="Tra cứu văn bản pháp luật và hỏi đáp thủ tục xuất nhập cảnh với Trợ lý ảo AI.">
    <meta property="og:image" content="https://raw.githubusercontent.com/username/repo/main/logo.png">
    <meta property="og:url" content="https://username.github.io/repo/">
    <meta property="og:type" content="website">

    <!-- Preload LCP Image -->
    <link rel="preload" href="ba-nhat-banner.jpg" as="image" fetchpriority="high">

    <!-- Preconnect for faster loading -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://unpkg.com">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com/3.4.17"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Playfair+Display:ital,wght@1,400;1,700&family=Dancing+Script:wght@700&display=swap"
        rel="stylesheet">

    <!-- Lucide Icons (deferred for performance) -->
    <script defer src="https://unpkg.com/lucide@0.563.0/dist/umd/lucide.min.js"
        integrity="sha384-aRB6X3zBuyu5EQF6GZFp0RCYdOwxYAOdFk4nViPfqSXYxc+MrZlqbM+nUYRwDQn1"
        crossorigin="anonymous"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cand-red': '#D00000',
                        'cand-red-dark': '#8B0000',
                        'cand-gold': '#FFD700',
                        'cand-gold-dark': '#B8860B',
                        'cand-gold-light': '#FCEda3',
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                        'playfair': ['Playfair Display', 'serif'],
                        'dancing': ['Dancing Script', 'cursive'],
                    },
                    boxShadow: {
                        'glow': '0 0 15px rgba(255, 215, 0, 0.5)',
                    }
                }
            }
        }
    </script>

    <style>
        * {
            font-family: 'Inter', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        /* Modern Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #D00000;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #8B0000;
        }

        /* Hero Background with Red Texture */
        .hero-section {
            background: linear-gradient(135deg, #D00000 0%, #8B0000 100%);
            position: relative;
            overflow: hidden;
        }

        .hero-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .hero-overlay {
            background: radial-gradient(circle at center, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
            position: absolute;
            inset: 0;
        }

        /* Text Effects */
        .text-3d {
            text-shadow: 2px 2px 0px #8B0000, 4px 4px 0px rgba(0, 0, 0, 0.2);
        }

        .text-glow {
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        /* Card Effects */
        .modern-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border-color: #FFD700;
        }

        /* Animations */
        @keyframes float {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }

            100% {
                transform: translateY(0px);
            }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        /* Button Shine */
        .btn-shine {
            position: relative;
            overflow: hidden;
        }

        .btn-shine::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: 0.5s;
        }

        .btn-shine:hover::after {
            left: 100%;
        }

        /* Chat Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.3s ease-out forwards;
        }

        .delay-100 {
            animation-delay: 0.1s;
        }

        /* Custom Scrollbar for Chat */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* ========== ACCESSIBILITY ========== */
        /* Skip to main content link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #D00000;
            color: white;
            padding: 8px 16px;
            z-index: 9999;
            transition: top 0.3s;
            text-decoration: none;
            font-weight: bold;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Reduced motion for users who prefer it */
        @media (prefers-reduced-motion: reduce) {

            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* Better focus states for keyboard navigation */
        a:focus-visible,
        button:focus-visible,
        input:focus-visible {
            outline: 3px solid #FFD700;
            outline-offset: 2px;
        }

        /* ========== PRINT STYLES ========== */
        @media print {

            .hero-section,
            #aiFloatingBtn,
            #header,
            #aiBubble,
            .btn-shine {
                display: none !important;
            }

            body {
                font-size: 12pt;
                line-height: 1.5;
            }

            .modern-card {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
    </style>
<script src="js/doc-data.js" defer></script>
    </head>

<body class="bg-gray-50 text-gray-800">
    <!-- Skip to main content (Accessibility) -->
    <a href="#main-content" class="skip-link">Chuyển đến nội dung chính / Skip to main content</a>


    <!-- ========== HEADER ========== -->
    <header id="header"
        class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-cand-red-dark/95 backdrop-blur-md shadow-lg border-b border-cand-gold/20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16 md:h-20">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <img src="logo.png" alt="Logo" class="w-10 h-10 md:w-12 md:h-12 object-contain drop-shadow-md">
                    <img src="logo-qlxnc.png" alt="QLXNC"
                        class="w-10 h-10 md:w-12 md:h-12 object-contain drop-shadow-md">
                    <div class="hidden md:block">
                        <h1 class="text-white font-bold text-base leading-none" data-i18n="unit_name_1">CÔNG AN TỈNH PHÚ
                            THỌ</h1>
                        <p class="text-cand-gold text-xs font-bold tracking-wider" data-i18n="unit_name_2">PHÒNG QUẢN LÝ
                            XUẤT NHẬP CẢNH</p>
                    </div>
                </div>

                <!-- Campaign Badge (New) -->
                <div class="hidden lg:flex items-center gap-3 ml-4 pl-4 border-l border-white/20">
                    <div class="relative w-10 h-10 flex items-center justify-center animate-pulse">
                        <div class="absolute inset-0 bg-cand-red rounded-full opacity-75 animate-ping"></div>
                        <div
                            class="relative bg-cand-red border-2 border-cand-gold rounded-full w-10 h-10 flex items-center justify-center shadow-glow z-10">
                            <i data-lucide="award" class="w-5 h-5 text-cand-gold"></i>
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-cand-gold font-bold text-sm uppercase leading-none filter drop-shadow-sm"
                            data-i18n="campaign_peak">Cao
                            điểm 70 ngày đêm</span>
                        <span class="text-white text-xs font-medium" data-i18n="campaign_digital">Tiên phong chuyển đổi
                            số</span>
                    </div>
                </div>

                <!-- Desktop Nav -->
                <nav class="hidden md:flex items-center gap-6">
                    <a href="#home" class="text-white/90 hover:text-cand-gold font-medium transition-colors"
                        data-i18n="home">Trang chủ</a>
                    <a href="#documents" class="text-white/90 hover:text-cand-gold font-medium transition-colors"
                        data-i18n="documents">Văn bản</a>
                    <a href="#ai-assistant"
                        class="px-5 py-2 bg-gradient-to-r from-cand-gold to-cand-gold-dark text-white font-bold rounded-full shadow-lg hover:shadow-glow transition-all transform hover:scale-105"
                        data-i18n="ai_assistant">
                        Hỏi đáp AI
                    </a>
                    <!-- Language Switcher -->
                    <div id="langSwitcher"
                        class="flex items-center gap-3 ml-4 bg-white/10 backdrop-blur-md px-4 py-2 rounded-full border border-white/20 transition-all hover:bg-white/20">
                        <div class="flex items-center gap-2 text-white/80 mr-2 border-r border-white/20 pr-3">
                            <i data-lucide="globe" class="w-4 h-4"></i>
                            <span class="text-xs font-medium uppercase hidden lg:inline" data-i18n="language">Ngôn
                                ngữ</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <button onclick="setLanguage('vi')"
                                class="text-cand-gold font-bold text-sm hover:text-white transition-all transform hover:scale-110"
                                id="lang-btn-vi">VN</button>
                            <span class="text-white/20 text-xs">|</span>
                            <button onclick="setLanguage('en')"
                                class="text-white/70 text-sm hover:text-cand-gold transition-all transform hover:scale-110"
                                id="lang-btn-en">EN</button>
                            <span class="text-white/20 text-xs">|</span>
                            <button onclick="setLanguage('zh')"
                                class="text-white/70 text-sm hover:text-cand-gold transition-all transform hover:scale-110"
                                id="lang-btn-zh">CN</button>
                            <span class="text-white/20 text-xs">|</span>
                            <button onclick="setLanguage('kr')"
                                class="text-white/70 text-sm hover:text-cand-gold transition-all transform hover:scale-110"
                                id="lang-btn-kr">KR</button>
                        </div>
                    </div>
                </nav>

                <!-- Mobile Language Switcher (visible on mobile only) -->
                <div class="flex items-center gap-2 md:hidden">
                    <div
                        class="flex items-center gap-1 bg-red-900/80 backdrop-blur-md px-3 py-1.5 rounded-full border border-cand-gold/50 shadow-lg ring-1 ring-white/10">
                        <i data-lucide="globe" class="w-3 h-3 text-cand-gold mr-1"></i>
                        <button onclick="setLanguage('vi')"
                            class="text-cand-gold font-bold text-xs hover:text-white transition-colors uppercase"
                            id="mob-header-lang-vi">VN</button>
                        <span class="text-white/40 text-[10px]">|</span>
                        <button onclick="setLanguage('en')"
                            class="text-white/80 text-xs hover:text-cand-gold transition-colors uppercase"
                            id="mob-header-lang-en">EN</button>
                        <span class="text-white/40 text-[10px]">|</span>
                        <button onclick="setLanguage('zh')"
                            class="text-white/80 text-xs hover:text-cand-gold transition-colors uppercase"
                            id="mob-header-lang-zh">CN</button>
                        <span class="text-white/40 text-[10px]">|</span>
                        <button onclick="setLanguage('kr')"
                            class="text-white/80 text-xs hover:text-cand-gold transition-colors uppercase"
                            id="mob-header-lang-kr">KR</button>
                    </div>

                    <!-- Mobile Menu Button -->
                    <button id="mobileMenuBtn" aria-label="Menu chính" aria-expanded="false"
                        class="text-white p-2 hover:bg-white/10 rounded-lg transition-colors">
                        <i data-lucide="menu" class="w-7 h-7"></i>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu Dropdown -->
            <div id="mobileMenu"
                class="hidden md:hidden border-t border-white/10 overflow-hidden transition-all duration-300 ease-in-out">
                <div class="py-4 space-y-2 flex flex-col">
                    <a href="#home"
                        class="block px-4 py-2 text-white/90 hover:bg-white/10 hover:text-cand-gold transition-colors rounded-lg"
                        onclick="toggleMobileMenu()" data-i18n="home">Trang chủ</a>
                    <a href="#documents"
                        class="block px-4 py-2 text-white/90 hover:bg-white/10 hover:text-cand-gold transition-colors rounded-lg"
                        onclick="toggleMobileMenu()" data-i18n="documents">Văn bản</a>
                    <a href="#ai-assistant"
                        class="block px-4 py-2 text-white/90 hover:bg-white/10 hover:text-cand-gold transition-colors rounded-lg"
                        onclick="toggleMobileMenu()" data-i18n="ai_assistant">Hỏi đáp AI</a>

                    <div class="px-4 pt-2 mt-2 border-t border-white/10 flex items-center gap-4">
                        <span class="text-white/60 text-sm" data-i18n="language">Ngôn ngữ:</span>
                        <div
                            class="flex items-center gap-2 bg-black/20 px-3 py-1.5 rounded-full border border-white/10">
                            <button onclick="setLanguage('vi')"
                                class="text-cand-gold font-bold text-sm hover:text-white transition-colors"
                                id="mob-lang-vi">VN</button>
                            <span class="text-white/40 text-xs">|</span>
                            <button onclick="setLanguage('en')"
                                class="text-white/70 text-sm hover:text-cand-gold transition-colors"
                                id="mob-lang-en">EN</button>
                            <span class="text-white/40 text-xs">|</span>
                            <button onclick="setLanguage('zh')"
                                class="text-white/70 text-sm hover:text-cand-gold transition-colors"
                                id="mob-lang-zh">CN</button>
                            <span class="text-white/40 text-xs">|</span>
                            <button onclick="setLanguage('kr')"
                                class="text-white/70 text-sm hover:text-cand-gold transition-colors"
                                id="mob-lang-kr">KR</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ========== HERO SECTION (BA NHAT) ========== -->
    <section id="home" class="hero-section min-h-screen flex items-center justify-center pt-20 relative">
        <div class="hero-pattern"></div>
        <div class="hero-overlay"></div>

        <!-- Background Image optional overlay -->
        <div class="absolute inset-0 opacity-20 pointer-events-none mix-blend-overlay"
            style="background-image: url('ba-nhat-banner.jpg'); background-size: cover; background-position: center;">
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center py-16">

            <!-- Logo Block -->
            <div class="mb-2 flex flex-col items-center justify-center">
                <img src="logo.png" alt="CAND" class="w-20 h-20 md:w-24 md:h-24 object-contain drop-shadow-2xl mb-2">
                <h2 class="text-white font-bold text-sm md:text-base leading-tight" data-i18n="unit_name_1">CÔNG AN TỈNH
                    PHÚ THỌ</h2>
                <p class="text-cand-gold font-bold text-xs md:text-sm tracking-wider" data-i18n="unit_name_2">PHÒNG QUẢN
                    LÝ XUẤT NHẬP CẢNH</p>
            </div>

            <div class="mb-6">
                <div
                    class="inline-flex flex-col items-center justify-center px-8 py-4 rounded-3xl bg-red-900/90 backdrop-blur-md border border-cand-gold shadow-xl max-w-4xl">
                    <span class="text-cand-gold font-bold uppercase text-xs md:text-sm tracking-widest mb-1"
                        data-i18n="anniv_line1">Công trình thanh niên chào mừng</span>
                    <span
                        class="text-white font-bold uppercase text-[10px] md:text-base tracking-wide leading-tight mt-1"
                        data-i18n="anniv_line2">95 năm thành lập Đoàn TNCS Hồ Chí Minh</span>
                    <span
                        class="text-white font-bold uppercase text-[10px] md:text-base tracking-wide leading-tight mt-1"
                        data-i18n="anniv_line3">70 năm truyền thống Đoàn Bộ Công an</span>
                </div>
            </div>

            <p class="font-dancing text-2xl md:text-4xl text-white mb-2 tracking-wide font-bold drop-shadow-md"
                data-i18n="hero_movement">Phong
                trào thi đua</p>

            <h1 class="font-black text-6xl md:text-8xl lg:text-9xl text-cand-gold text-3d mb-8 tracking-tighter uppercase relative inline-block"
                data-i18n="hero_3best">
                BA NHẤT
                <!-- Stars -->
                <div class="flex justify-center gap-4 mt-2 mb-4 text-cand-gold text-2xl md:text-4xl">
                    <i data-lucide="star"
                        class="fill-current w-8 h-8 md:w-12 md:h-12 filter drop-shadow hover:scale-125 transition-transform duration-300"></i>
                    <i data-lucide="star"
                        class="fill-current w-8 h-8 md:w-12 md:h-12 filter drop-shadow -mt-4 hover:scale-125 transition-transform duration-300"></i>
                    <i data-lucide="star"
                        class="fill-current w-8 h-8 md:w-12 md:h-12 filter drop-shadow hover:scale-125 transition-transform duration-300"></i>
                </div>
            </h1>

            <div class="space-y-4 md:space-y-6 mb-12">
                <div class="transform hover:scale-105 transition-transform duration-300">
                    <h2 class="text-3xl md:text-5xl font-bold text-white uppercase tracking-tight drop-shadow-lg">
                        <span class="text-cand-gold">"</span><span data-i18n="best_discipline">KỶ LUẬT NHẤT</span><span
                            class="text-cand-gold">"</span>
                    </h2>
                </div>
                <div class="transform hover:scale-105 transition-transform duration-300">
                    <h2 class="text-3xl md:text-5xl font-bold text-white uppercase tracking-tight drop-shadow-lg">
                        <span class="text-cand-gold">"</span><span data-i18n="best_loyalty">TRUNG THÀNH NHẤT</span><span
                            class="text-cand-gold">"</span>
                    </h2>
                </div>
                <div class="transform hover:scale-105 transition-transform duration-300">
                    <h2 class="text-3xl md:text-5xl font-bold text-white uppercase tracking-tight drop-shadow-lg">
                        <span class="text-cand-gold">"</span><span data-i18n="best_closeness">GẦN DÂN NHẤT</span><span
                            class="text-cand-gold">"</span>
                    </h2>
                </div>
            </div>

            <div class="max-w-3xl mx-auto border-t border-cand-gold/50 pt-6 mt-6">
                <div class="flex flex-col gap-2 text-white/90 text-sm md:text-lg font-bold uppercase tracking-wider">
                    <p data-i18n="motto_1">KỶ LUẬT LÀ NỀN TẢNG</p>
                    <p data-i18n="motto_2">TRUNG THÀNH LÀ CỐT LÕI</p>
                    <p data-i18n="motto_3">GẦN DÂN LÀ THƯỚC ĐO</p>
                </div>
            </div>

            <div class="mt-12 flex flex-col sm:flex-row gap-4 justify-center">
                <a href="#documents"
                    class="px-8 py-4 bg-white text-cand-red-dark font-bold rounded-full shadow-xl hover:bg-gray-100 transition-all btn-shine flex items-center justify-center gap-2">
                    <i data-lucide="file-text" class="w-5 h-5"></i>
                    <span data-i18n="search_docs">Tra cứu Văn bản</span>
                </a>
                <a href="#ai-assistant"
                    class="px-8 py-4 bg-cand-gold text-cand-red-dark font-bold rounded-full shadow-xl hover:bg-cand-gold-dark hover:text-white transition-all btn-shine flex items-center justify-center gap-2">
                    <i data-lucide="bot" class="w-5 h-5"></i>
                    <span data-i18n="ask_ai">Hỏi Trợ lý AI</span>
                </a>
            </div>
        </div>

        <!-- Bottom Wave optional -->
        <div class="absolute bottom-0 left-0 w-full overflow-hidden leading-none">
            <svg class="relative block w-full h-[50px] md:h-[100px]" data-name="Layer 1"
                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
                <path
                    d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z"
                    class="fill-gray-50"></path>
            </svg>
        </div>
    </section>

    <!-- ========== DOCUMENTS SECTION ========== -->
    <main id="main-content">
        <section id="documents" class="py-20 bg-gray-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h3 class="text-3xl md:text-5xl font-bold text-cand-red-dark mb-4 drop-shadow-sm font-playfair"
                        data-i18n="docs_title">Kho Văn Bản Pháp Luật</h3>
                    <div class="w-24 h-1 bg-cand-gold mx-auto rounded-full"></div>
                </div>

                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Card 1 -->
                    <div class="modern-card rounded-2xl p-6 md:p-8 relative group">
                        <div
                            class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-cand-red to-cand-gold rounded-t-2xl">
                        </div>
                        <div
                            class="w-14 h-14 bg-cand-red/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-cand-red group-hover:text-white transition-colors duration-300">
                            <i data-lucide="gavel" class="w-7 h-7 text-cand-red group-hover:text-white"></i>
                        </div>
                        <span
                            class="inline-block px-3 py-1 bg-cand-red/10 text-cand-red text-xs font-bold rounded-full mb-3 border border-cand-red/20"
                            data-i18n="tag_decree">NGHỊ
                            ĐỊNH</span>
                        <h4 id="doc1-title"
                            class="text-xl font-bold text-gray-900 mb-3 group-hover:text-cand-red transition-colors"
                            data-i18n="doc1_title">Nghị
                            định 282/2025/NĐ-CP</h4>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3" data-i18n="doc1_desc">Quy định xử phạt vi
                            phạm
                            hành chính trong lĩnh
                            vực an ninh, trật tự, an toàn xã hội.</p>



                        <div class="flex gap-3 mt-auto">
                            <button id="doc1-btn" aria-labelledby="doc1-btn doc1-title" onclick="openModal('doc1')"
                                class="flex-1 py-2 border border-cand-red text-cand-red rounded-lg font-semibold hover:bg-cand-red hover:text-white transition-all"
                                data-i18n="view_quick">Xem
                                nhanh</button>
                            <a href="2025_1583_1584_282_2025_ND_CP.pdf" target="_blank" rel="noopener noreferrer"
                                class="flex-1 py-2 bg-cand-red text-white rounded-lg font-semibold text-center hover:bg-cand-red-dark hover:shadow-lg transition-all"
                                data-i18n="open_file">Mở
                                file</a>
                        </div>
                    </div>

                    <!-- Card 2 -->
                    <div class="modern-card rounded-2xl p-6 md:p-8 relative group">
                        <div
                            class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-cand-red to-cand-gold rounded-t-2xl">
                        </div>
                        <div
                            class="w-14 h-14 bg-cand-red/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-cand-red group-hover:text-white transition-colors duration-300">
                            <i data-lucide="book" class="w-7 h-7 text-cand-red group-hover:text-white"></i>
                        </div>
                        <span
                            class="inline-block px-3 py-1 bg-cand-red/10 text-cand-red text-xs font-bold rounded-full mb-3 border border-cand-red/20"
                            data-i18n="tag_law">LUẬT</span>
                        <h4 id="doc2-title"
                            class="text-xl font-bold text-gray-900 mb-3 group-hover:text-cand-red transition-colors"
                            data-i18n="doc2_title">LUẬT
                            NHẬP CẢNH, XUẤT CẢNH, QUÁ CẢNH, CƯ TRÚ CỦA NGƯỜI NƯỚC NGOÀI TẠI VIỆT NAM</h4>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3" data-i18n="doc2_desc">Văn bản hợp nhất quy
                            định
                            về nhập cảnh, xuất
                            cảnh, quá cảnh, cư trú của người nước ngoài.</p>



                        <div class="flex gap-3 mt-auto">
                            <button id="doc2-btn" aria-labelledby="doc2-btn doc2-title" onclick="openModal('doc2')"
                                class="flex-1 py-2 border border-cand-red text-cand-red rounded-lg font-semibold hover:bg-cand-red hover:text-white transition-all"
                                data-i18n="view_quick">Xem
                                nhanh</button>
                            <a href="2023_1257_1258_30_VBHN_VPQH.pdf" target="_blank" rel="noopener noreferrer"
                                class="flex-1 py-2 bg-cand-red text-white rounded-lg font-semibold text-center hover:bg-cand-red-dark hover:shadow-lg transition-all"
                                data-i18n="open_file">Mở
                                file</a>
                        </div>
                    </div>

                    <!-- Card 3 -->
                    <div class="modern-card rounded-2xl p-6 md:p-8 relative group">
                        <div
                            class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-cand-red to-cand-gold rounded-t-2xl">
                        </div>
                        <div
                            class="w-14 h-14 bg-cand-red/10 rounded-full flex items-center justify-center mb-4 group-hover:bg-cand-red group-hover:text-white transition-colors duration-300">
                            <i data-lucide="landmark" class="w-7 h-7 text-cand-red group-hover:text-white"></i>
                        </div>
                        <span
                            class="inline-block px-3 py-1 bg-cand-red/10 text-cand-red text-xs font-bold rounded-full mb-3 border border-cand-red/20"
                            data-i18n="tag_regulation">QUY
                            CHẾ</span>
                        <h4 id="doc3-title"
                            class="text-xl font-bold text-gray-900 mb-3 group-hover:text-cand-red transition-colors"
                            data-i18n="doc3_title">Quy chế
                            phối hợp trong quản lý người nước ngoài cư trú, hoạt động trên địa bàn tỉnh Phú Thọ</h4>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-3" data-i18n="doc3_desc">Quy định về phối hợp
                            quản
                            lý người nước ngoài
                            trên địa bàn tỉnh Phú Thọ.</p>



                        <div class="flex gap-3 mt-auto">
                            <button id="doc3-btn" aria-labelledby="doc3-btn doc3-title" onclick="openModal('doc3')"
                                class="flex-1 py-2 border border-cand-red text-cand-red rounded-lg font-semibold hover:bg-cand-red hover:text-white transition-all"
                                data-i18n="view_quick">Xem
                                nhanh</button>
                            <a href="Quy_che_phoi_hop_quan_ly_NNN_Phu_Tho.pdf" target="_blank" rel="noopener noreferrer"
                                class="flex-1 py-2 bg-cand-red text-white rounded-lg font-semibold text-center hover:bg-cand-red-dark hover:shadow-lg transition-all"
                                data-i18n="open_file">Mở
                                file</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== AI ASSISTANT SECTION ========== -->
        <section id="ai-assistant" class="py-20 bg-white relative overflow-hidden">
            <div class="absolute top-0 right-0 w-1/3 h-full bg-cand-red/5 skew-x-12 transform translate-x-32"></div>
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                <div class="flex flex-col lg:flex-row items-center gap-16">
                    <div class="lg:w-1/2">
                        <div class="flex items-center gap-3 mb-6">
                            <img src="icon.png" alt="Biểu tượng trợ lý AI" loading="lazy" decoding="async"
                                class="w-12 h-12 md:w-16 md:h-16 object-contain drop-shadow-md">
                            <h3 class="text-2xl sm:text-3xl md:text-5xl font-bold text-cand-red-dark font-playfair leading-tight whitespace-nowrap"
                                data-i18n="ai_section_title">
                                Trợ Lý Ảo Pháp Luật
                            </h3>
                        </div>
                        <p class="text-lg text-gray-600 mb-8 leading-relaxed" data-i18n="ai_section_desc">
                            Hệ thống giải đáp tự động thông minh, giúp bạn tra cứu nhanh chóng các quy định về xuất nhập
                            cảnh. Chính xác - Nhanh chóng - Tiện lợi.
                        </p>
                        <a href="https://notebooklm.google.com/notebook/03f2338f-f7f7-4adf-aba3-52b93672b484"
                            target="_blank" rel="noopener noreferrer"
                            class="inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-cand-red to-cand-red-dark text-white font-bold rounded-full shadow-lg hover:shadow-glow hover:scale-105 transition-all duration-300">
                            <i data-lucide="message-circle" class="w-6 h-6"></i>
                            <span data-i18n="chat_now">Trò chuyện ngay</span>
                        </a>
                    </div>
                    <div class="lg:w-1/2 relative">
                        <div class="relative z-10 bg-white rounded-3xl shadow-2xl p-2 border border-gray-100">
                            <div class="bg-gray-50 rounded-2xl p-6 md:p-8 flex flex-col h-[450px]">
                                <!-- Chat Header -->
                                <div class="flex items-center gap-4 mb-4 border-b border-gray-200 pb-4 shrink-0">
                                    <div
                                        class="w-12 h-12 bg-cand-red rounded-full flex items-center justify-center text-white shadow-md relative">
                                        <i data-lucide="bot" class="w-6 h-6"></i>
                                        <span
                                            class="absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-white rounded-full"></span>
                                    </div>
                                    <div>
                                        <h5 class="font-bold text-gray-900 text-lg" data-i18n="ai_name">Trợ lý AI</h5>
                                        <span
                                            class="text-green-600 text-xs font-bold flex items-center gap-1 bg-green-100 px-2 py-0.5 rounded-full w-fit">
                                            <span class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"></span>
                                            <span data-i18n="online_status">Sẵn sàng hỗ trợ</span>
                                        </span>
                                    </div>
                                </div>

                                <!-- Chat History (Scrollable) -->
                                <div id="chatHistory"
                                    class="flex-1 overflow-y-auto space-y-4 mb-4 pr-2 custom-scrollbar">
                                    <!-- AI Welcome Message -->
                                    <div class="flex justify-start animate-fade-in-up">
                                        <div
                                            class="bg-white text-gray-800 border border-gray-200 px-4 py-3 rounded-2xl rounded-tl-sm shadow-sm max-w-[90%]">
                                            <p class="text-sm leading-relaxed" data-i18n="ai_welcome">
                                                Xin chào! Tôi là Trợ lý AI pháp luật. Bạn muốn hỏi gì về thủ tục xuất
                                                nhập
                                                cảnh hôm nay?
                                            </p>
                                        </div>
                                    </div>
                                    <!-- Suggested Questions -->
                                    <div class="flex flex-wrap gap-2 animate-fade-in-up delay-100">
                                        <button onclick="fillChat('Thủ tục làm hộ chiếu?')"
                                            class="text-xs bg-white border border-cand-gold text-gray-600 px-3 py-1.5 rounded-full hover:bg-cand-gold hover:text-white transition-colors">
                                            Thủ tục làm hộ chiếu?
                                        </button>
                                        <button onclick="fillChat('Gia hạn visa cho người nước ngoài?')"
                                            class="text-xs bg-white border border-cand-gold text-gray-600 px-3 py-1.5 rounded-full hover:bg-cand-gold hover:text-white transition-colors">
                                            Gia hạn visa?
                                        </button>
                                    </div>
                                </div>

                                <!-- Input Area -->
                                <div class="relative shrink-0 pt-2 border-t border-gray-100">
                                    <input type="text" id="fakeChatInput"
                                        class="w-full pl-4 pr-12 py-3.5 rounded-xl border border-gray-200 bg-white focus:outline-none focus:border-cand-red focus:ring-2 focus:ring-cand-red/20 transition-all shadow-sm text-sm"
                                        placeholder="Nhập câu hỏi của bạn..." onkeypress="handleChatEnter(event)">
                                    <button onclick="handleChatSend()"
                                        class="absolute right-2 top-1/2 mt-1 -translate-y-1/2 w-9 h-9 bg-cand-red text-white rounded-lg flex items-center justify-center hover:bg-cand-red-dark transition-colors shadow-md hover:shadow-lg transform active:scale-95">
                                        <i data-lucide="send" class="w-4 h-4 ml-0.5"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Decorative blobs -->
                            <div
                                class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-cand-gold/20 filter blur-3xl -z-10 rounded-full">
                            </div>
                        </div>
                    </div>
                </div>
        </section>

        <!-- ========== FOOTER ========== -->
        <footer class="bg-cand-red-dark text-white pt-16 pb-8 border-t-4 border-cand-gold">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col items-center justify-center text-center mb-8">
                    <div class="flex items-center gap-3 mb-4">
                        <!-- Bolt: Added lazy loading for offscreen image -->
                        <img src="logo.png" alt="Logo" loading="lazy" decoding="async"
                            class="w-12 h-12 object-contain bg-white rounded-full p-1">
                        <div class="text-left">
                            <h4 class="font-bold text-lg leading-none" data-i18n="unit_name_1">CÔNG AN TỈNH PHÚ THỌ</h4>
                            <p class="text-cand-gold text-xs font-bold mt-1" data-i18n="footer_slogan">VÌ NƯỚC QUÊN THÂN
                                -
                                VÌ DÂN PHỤC VỤ</p>
                            <p class="text-white/90 text-sm font-bold mt-2 uppercase tracking-wide border-t border-white/20 pt-2"
                                data-i18n="footer_action">
                                Tuổi trẻ Công an Đất Tổ: Xung kích - Lập công - Vì an ninh Tổ quốc
                            </p>
                        </div>
                    </div>
                </div>
                <!-- Visitor Stats -->
                <!-- Visitor Stats -->
                <div class="grid grid-cols-2 gap-4 max-w-sm mx-auto mb-8 border-t border-b border-white/10 py-6">
                    <!-- Removed Online Stats as requested -->
                    <div class="text-center">
                        <p class="text-cand-gold font-bold text-xl" id="stat-today">...</p>
                        <p class="text-white/70 text-xs uppercase" data-i18n="stat_today">Hôm nay</p>
                    </div>
                    <div class="text-center border-l border-white/10">
                        <p class="text-cand-gold font-bold text-xl" id="stat-total">...</p>
                        <p class="text-white/70 text-xs uppercase" data-i18n="stat_total">Tổng truy cập</p>
                    </div>
                </div>

                <div class="border-t border-white/10 pt-8 text-center">
                    <p class="text-white/60 text-sm font-medium uppercase tracking-wide" data-i18n="designed_by_label">
                        Thiết
                        kế bởi Đại úy Vi Ngọc Phương
                    </p>
                    <p class="text-white/60 text-sm font-medium uppercase tracking-wide mt-1"
                        data-i18n="designed_by_role">
                        Bí thư Chi đoàn ghép Phòng
                        PA01-PA08</p>
                </div>
            </div>
        </footer>
    </main>

    <!-- ========== FLOATING BUTTON ========== -->
    <a id="aiFloatingBtn" href="https://notebooklm.google.com/notebook/03f2338f-f7f7-4adf-aba3-52b93672b484"
        target="_blank" rel="noopener noreferrer" class="fixed bottom-0 right-4 z-50 flex items-end group">

        <!-- Speech Bubble -->
        <div id="aiBubble"
            class="mb-20 mr-[-5px] bg-white border-2 border-cand-gold text-gray-800 px-3 py-2 rounded-xl rounded-br-none shadow-lg max-w-[160px] relative transition-all duration-500 opacity-100 transform translate-y-0">
            <p class="text-xs font-bold leading-tight" data-i18n="bubble_text">Xin chào ! Tôi là Trợ lý AI, bạn có
                cần
                giúp gì không?</p>
            <div
                class="absolute -right-2 bottom-0 w-0 h-0 border-l-[8px] border-l-transparent border-t-[8px] border-t-cand-gold border-r-[8px] border-r-transparent transform -skew-x-12">
            </div>
        </div>

        <!-- Character -->
        <img src="icon.png"
            class="w-32 h-32 md:w-40 md:h-40 object-contain drop-shadow-2xl hover:scale-105 transition-transform duration-300"
            alt="Chat">
    </a>

    <!-- ========== MODAL (SAME LOGIC) ========== -->
    <div id="docModal" class="fixed inset-0 z-[100] hidden" role="dialog" aria-modal="true"
        aria-labelledby="modalTitle">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="absolute inset-4 md:inset-20 bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col animate-float"
            style="animation: none;">
            <div class="flex items-center justify-between p-6 bg-cand-red-dark text-white">
                <h3 id="modalTitle" class="text-xl font-bold">Title</h3>
                <button onclick="closeModal()" class="hover:bg-white/20 p-2 rounded-lg" id="modalCloseBtn"
                    aria-labelledby="modalCloseLabel">
                    <span id="modalCloseLabel" class="sr-only" data-i18n="close_btn">Đóng</span>
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div id="modalBody" class="flex-1 p-6 overflow-y-auto"></div>
            <div class="p-6 bg-gray-50 flex justify-end gap-3">
                <button onclick="closeModal()" class="px-6 py-2 border rounded-lg hover:bg-gray-100"
                    data-i18n="close_btn">Đóng</button>
                <a id="modalPdfLink" href="#" target="_blank" rel="noopener noreferrer"
                    class="px-6 py-2 bg-cand-red text-white rounded-lg hover:bg-cand-red-dark"
                    data-i18n="view_details_btn">Xem chi tiết</a>
            </div>
        </div>
    </div>

    <!-- ========== ONBOARDING REMOVED ========== -->



    <!-- Scripts -->
    <script>
        // ========== MULTI-LANGUAGE SUPPORT ==========
        const translations = {
            vi: {
                home: "Trang chủ",
                documents: "Văn bản",
                ai_assistant: "Hỏi đáp AI",
                language: "Ngôn ngữ:",
                search_docs: "Tra cứu Văn bản",
                ask_ai: "Hỏi Trợ lý AI",
                docs_title: "Kho Văn Bản Pháp Luật",
                view_quick: "Xem nhanh",
                open_file: "Mở file",
                motto_1: "KỶ LUẬT LÀ NỀN TẢNG",
                motto_2: "TRUNG THÀNH LÀ CỐT LÕI",
                motto_3: "GẦN DÂN LÀ THƯỚC ĐO",
                unit_name_1: "CÔNG AN TỈNH PHÚ THỌ",
                unit_name_2: "PHÒNG QUẢN LÝ XUẤT NHẬP CẢNH",
                hero_movement: "Phong trào thi đua",
                hero_3best: "BA NHẤT",
                best_discipline: "KỶ LUẬT NHẤT",
                best_loyalty: "TRUNG THÀNH NHẤT",
                best_closeness: "GẦN DÂN NHẤT",
                tag_decree: "NGHỊ ĐỊNH",
                tag_law: "LUẬT",
                tag_regulation: "QUY CHẾ",
                doc1_title: "Nghị định 282/2025/NĐ-CP",
                doc1_desc: "Quy định xử phạt vi phạm hành chính trong lĩnh vực an ninh, trật tự, an toàn xã hội.",
                doc2_title: "LUẬT NHẬP CẢNH, XUẤT CẢNH, QUÁ CẢNH, CƯ TRÚ CỦA NGƯỜI NƯỚC NGOÀI TẠI VIỆT NAM",
                doc2_desc: "Văn bản hợp nhất quy định về nhập cảnh, xuất cảnh, quá cảnh, cư trú của người nước ngoài.",
                doc3_title: "Quy chế phối hợp trong quản lý người nước ngoài cư trú, hoạt động trên địa bàn tỉnh Phú Thọ",
                doc3_desc: "Quy định về phối hợp quản lý người nước ngoài trên địa bàn tỉnh Phú Thọ.",
                ai_section_title: "Trợ Lý Ảo Pháp Luật",
                ai_section_desc: "Hệ thống giải đáp tự động thông minh, giúp bạn tra cứu nhanh chóng các quy định về xuất nhập cảnh. Chính xác - Nhanh chóng - Tiện lợi.",
                chat_now: "Trò chuyện ngay",
                ai_name: "Trợ lý AI",
                chat_demo_q: "Thủ tục gia hạn visa du lịch gồm những gì?",
                chat_demo_a: "Theo quy định mới nhất, bạn cần chuẩn bị: Hộ chiếu gốc, tờ khai NA5, và xác nhận tạm trú...",
                footer_slogan: "VÌ NƯỚC QUÊN THÂN - VÌ DÂN PHỤC VỤ",
                designed_by_label: "Thiết kế bởi Đại úy Vi Ngọc Phương",
                designed_by_role: "Bí thư Chi đoàn ghép Phòng PA01-PA08",
                online_status: "Online",
                online_status: "Online",
                bubble_text: "Xin chào ! Tôi là Trợ lý AI, bạn có cần giúp gì không?",
                campaign_peak: "Cao điểm 70 ngày đêm",
                campaign_digital: "Tiên phong chuyển đổi số",
                campaign_peak: "Cao điểm 70 ngày đêm",
                campaign_digital: "Tiên phong chuyển đổi số",
                anniv_line1: "Công trình thanh niên chào mừng",
                anniv_line2: "95 năm thành lập Đoàn TNCS Hồ Chí Minh",
                anniv_line3: "70 năm truyền thống Đoàn Bộ Công an",
                footer_action: "Tuổi trẻ Công an Đất Tổ: Xung kích - Lập công - Vì an ninh Tổ quốc",
                close_btn: "Đóng",
                view_details_btn: "Xem chi tiết",
                stat_online: "Đang Online",
                stat_today: "Hôm nay",
                stat_total: "Tổng truy cập"
            },
            en: {
                home: "Home",
                documents: "Legal Docs",
                ai_assistant: "AI Assistant",
                language: "Language:",
                search_docs: "Search Documents",
                ask_ai: "Ask AI Assistant",
                docs_title: "Legal Documents Library",
                view_quick: "Quick View",
                open_file: "Open File",
                motto_1: "DISCIPLINE IS THE FOUNDATION",
                motto_2: "LOYALTY IS THE CORE",
                motto_3: "CLOSENESS TO PEOPLE IS THE MEASURE",
                unit_name_1: "PHU THO PROVINCIAL POLICE",
                unit_name_2: "IMMIGRATION DEPARTMENT",
                hero_movement: "Emulation Movement",
                hero_3best: "THREE BESTs",
                best_discipline: "MOST DISCIPLINED",
                best_loyalty: "MOST LOYAL",
                best_closeness: "CLOSEST TO PEOPLE",
                tag_decree: "DECREE",
                tag_law: "LAW",
                tag_regulation: "REGULATION",
                doc1_title: "Decree 282/2025/ND-CP",
                doc1_desc: "Regulations on administrative penalties in the fields of security, order, and social safety.",
                doc2_title: "LAW ON ENTRY, EXIT, TRANSIT, AND RESIDENCE OF FOREIGNERS IN VIETNAM",
                doc2_desc: "Consolidated text regulating entry, exit, transit, and residence of foreigners.",
                doc3_title: "Regulation on coordination in managing foreigners residing and operating in Phu Tho province",
                doc3_desc: "Regulations on coordination in managing foreigners in Phu Tho province.",
                ai_section_title: "Legal AI Assistant",
                ai_section_desc: "Smart automated answering system helping you quickly look up immigration regulations. Accurate - Fast - Convenient.",
                chat_now: "Chat Now",
                ai_name: "AI Assistant",
                chat_demo_q: "What are the procedures for extending a tourist visa?",
                chat_demo_a: "According to the latest regulations, you need: Original passport, NA5 form, and temporary residence confirmation...",
                footer_slogan: "DEVOTED TO FATHERLAND - SERVING THE PEOPLE",
                designed_by_label: "Designed by Captain Vi Ngoc Phuong",
                designed_by_role: "Secretary of Joint Youth Union PA01-PA08",
                online_status: "Online",
                bubble_text: "Hello! I am AI Assistant, surely allow me to help you?",
                campaign_peak: "70-Day Peak Campaign",
                campaign_digital: "Pioneering Digital Transformation",
                campaign_peak: "70-Day Peak Campaign",
                campaign_digital: "Pioneering Digital Transformation",
                anniv_line1: "Youth Work Celebrating",
                anniv_line2: "95th Anniversary of Ho Chi Minh Communist Youth Union",
                anniv_line3: "70th Anniversary of MPS Youth Union Tradition",
                footer_action: "Phu Tho Police Youth: Shock - Achievement - For National Security",
                close_btn: "Close",
                view_details_btn: "View Details",
                stat_online: "Online",
                stat_today: "Today",
                stat_total: "Total Visits"
            },
            zh: {
                home: "首页",
                documents: "法律文件",
                ai_assistant: "AI 助手",
                language: "语言:",
                search_docs: "查询文件",
                ask_ai: "咨询 AI 助手",
                docs_title: "法律文件库",
                view_quick: "快速查看",
                open_file: "打开文件",
                motto_1: "纪律是基础",
                motto_2: "忠诚是核心",
                motto_3: "亲民是标准",
                unit_name_1: "富寿省公安厅",
                unit_name_2: "出入境管理处",
                hero_movement: "竞赛运动",
                hero_3best: "三个最",
                best_discipline: "纪律最严",
                best_loyalty: "最忠诚",
                best_closeness: "最亲民",
                tag_decree: "议定",
                tag_law: "法律",
                tag_regulation: "规制",
                doc1_title: "第 282/2025/NĐ-CP 号议定",
                doc1_desc: "规定安全、秩序和社会安全领域的行政违法处罚。",
                doc2_title: "关于外国人在越南入境、出境、过境、居留法",
                doc2_desc: "关于外国人在越南入境、出境、过境、居留规定的合并文本。",
                doc3_title: "富寿省外国人居留、活动管理协调规制",
                doc3_desc: "关于富寿省外国人管理协调的规定。",
                ai_section_title: "法律虚拟助手",
                ai_section_desc: "智能自动解答系统，帮助您快速查询出入境规定。准确 - 快速 - 便捷。",
                chat_now: "立即交谈",
                ai_name: "AI 助手",
                chat_demo_q: "旅游签证延期手续包括什么？",
                chat_demo_a: "根据最新规定，您需要准备：护照原件、NA5 申报表和暂住证明...",
                footer_slogan: "忘我为国 - 服务为民",
                designed_by_label: "设计者：韦玉方上尉",
                designed_by_role: "PA01-PA08 联合团支部书记",
                online_status: "在线",
                bubble_text: "你好！我是 AI 助手，有什么可以帮您吗？",
                campaign_peak: "70 天巅峰冲刺",
                campaign_digital: "数字化转型先锋",
                anniv_line1: "青年工程 庆祝",
                anniv_line2: "胡志明共青团成立 95 周年",
                anniv_line3: "公安部共青团传统 70 周年",
                footer_action: "富寿公安青年：突击 - 立功 - 为了祖国安全",
                close_btn: "关闭",
                view_details_btn: "查看详情",
                stat_online: "在线",
                stat_today: "今日",
                stat_total: "总访问量"
            },
            kr: {
                home: "홈",
                documents: "법률 문서",
                ai_assistant: "AI 도우미",
                language: "언어:",
                search_docs: "문서 검색",
                ask_ai: "AI 도우미 질문",
                docs_title: "법률 문서 보관소",
                view_quick: "빠른 보기",
                open_file: "파일 열기",
                motto_1: "규율은 기초",
                motto_2: "충성은 핵심",
                motto_3: "국민 친화는 척도",
                unit_name_1: "푸토성 공안",
                unit_name_2: "출입국 관리 처",
                hero_movement: "경쟁 운동",
                hero_3best: "3가지 최고",
                best_discipline: "최고의 규율",
                best_loyalty: "최고의 충성",
                best_closeness: "가장 친근한",
                tag_decree: "시행령",
                tag_law: "법률",
                tag_regulation: "규정",
                doc1_title: "시행령 282/2025/NĐ-CP",
                doc1_desc: "안보, 질서 및 사회 안전 분야의 행정 위반 처벌 규정.",
                doc2_title: "베트남 내 외국인의 입국, 출국, 경유, 거주에 관한 법률",
                doc2_desc: "외국인의 입국, 출국, 경유, 거주 규정에 관한 통합 문서.",
                doc3_title: "푸토성 내 외국인 거주 및 활동 관리 협력 규정",
                doc3_desc: "푸토성 내 외국인 관리 협력에 관한 규정.",
                ai_section_title: "법률 가상 비서",
                ai_section_desc: "출입국 규정을 신속하게 검색할 수 있도록 도와주는 지능형 자동 응답 시스템. 정확 - 신속 - 편리.",
                chat_now: "지금 채팅하기",
                ai_name: "AI 도우미",
                chat_demo_q: "관광 비자 연장 절차는 어떻게 되나요?",
                chat_demo_a: "최신 규정에 따르면: 여권 원본, NA5 신고서, 임시 거주 확인서가 필요합니다...",
                footer_slogan: "조국을 위해 헌신 - 국민을 위해 봉사",
                designed_by_label: "디자인: Vi Ngoc Phuong 대위",
                designed_by_role: "PA01-PA08 연합 청년단 서기",
                online_status: "온라인",
                bubble_text: "안녕하세요! AI 도우미입니다. 무엇을 도와드릴까요?",
                campaign_peak: "70일 집중 캠페인",
                campaign_digital: "디지털 전환 선도",
                anniv_line1: "청년 공사 축하",
                anniv_line2: "호치민 공산청년단 창립 95주년",
                anniv_line3: "공안부 청년단 전통 70주년",
                footer_action: "푸토 공안 청년: 돌격 - 공로 - 조국 안보를 위하여",
                close_btn: "닫기",
                view_details_btn: "자세히 보기",
                stat_online: "온라인",
                stat_today: "오늘",
                stat_total: "총 방문수"
            }
        };

        let currentLang = 'vi';

        function setLanguage(lang) {
            currentLang = lang;

            // Update Text Content
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    el.innerText = translations[lang][key];
                }
            });

            // Update Buttons State
            const ids = ['lang-btn-vi', 'lang-btn-en', 'lang-btn-zh', 'lang-btn-kr', 'mob-lang-vi', 'mob-lang-en', 'mob-lang-zh', 'mob-lang-kr', 'mob-header-lang-vi', 'mob-header-lang-en', 'mob-header-lang-zh', 'mob-header-lang-kr'];
            ids.forEach(id => {
                const el = document.getElementById(id);
                if (!el) return;

                // Check if this button matches current lang
                const isSelected = id.endsWith(lang);
                if (isSelected) {
                    el.classList.add('text-cand-gold', 'font-bold');
                    el.classList.remove('text-white/70');
                } else {
                    el.classList.remove('text-cand-gold', 'font-bold');
                    el.classList.add('text-white/70');
                }
            });

            // Special cases (updating docData titles if we wanted to go deep, but for now we keep doc content in VI mainly as it's legal docs)
            // But we can update the modal buttons if they were separate, but they are inside HTML string in docData. 
            // For a simple implementation, we assume doc content stays Vietnamese.
        }

        // ========== MOBILE MENU ==========
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');

        function toggleMobileMenu() {
            const isHidden = mobileMenu.classList.toggle('hidden');
            mobileMenuBtn.setAttribute('aria-expanded', !isHidden);
        }

        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', toggleMobileMenu);
        }

        // ========== MODAL FUNCTIONALITY ==========
        let lastFocusedElement = null;

        // docData moved to js/doc-data.js

        function openModal(id) {
            lastFocusedElement = document.activeElement; // Save trigger element

            const data = docData[id];
            if (!data) return;

            let title = data.title;
            let content = data.content;

            // Multi-language support
            if (data.vi && data.en) {
                const lang = currentLang || 'vi';
                title = data[lang].title;
                content = data[lang].content;
            }

            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('modalPdfLink').href = data.pdfLink;

            // Re-render icons in the new content
            lucide.createIcons();

            const modal = document.getElementById('docModal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling

            // Accessibility: Focus management
            // Focus the Close (X) button by default
            const closeBtn = document.getElementById('modalCloseBtn');
            if (closeBtn) {
                setTimeout(() => closeBtn.focus(), 50);
            }
        }

        function closeModal() {
            const modal = document.getElementById('docModal');
            modal.classList.add('hidden');
            document.body.style.overflow = '';

            // Restore focus
            if (lastFocusedElement) {
                lastFocusedElement.focus();
            }
        }

        // Close modal on escape key
        document.addEventListener('keydown', function (event) {
            if (event.key === "Escape") {
                closeModal();
            }
        });

        // Auto hide bubble on scroll
        const bubble = document.getElementById('aiBubble');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 100) {
                bubble.classList.add('opacity-0', 'translate-y-4', 'pointer-events-none');
            } else {
                bubble.classList.remove('opacity-0', 'translate-y-4', 'pointer-events-none');
            }
        });



        // ========== SERVICE WORKER REGISTRATION ==========
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('SW registered:', registration);
                    })
                    .catch(error => {
                        console.log('SW registration failed:', error);
                    });
            });
        }

        // ========== SECURITY: XSS PREVENTION ==========
        function sanitizeHTML(str) {
            const escapeMap = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#39;',
                '/': '&#x2F;',
                '`': '&#x60;',
                '=': '&#x3D;'
            };
            return String(str).replace(/[&<>"'`=\/]/g, s => escapeMap[s]);
        }

        // ========== FAKE CHAT FUNCTIONALITY ==========
        function handleChatSend() {
            const input = document.getElementById('fakeChatInput');
            const query = input.value.trim();
            if (!query) return;

            // SECURITY: Sanitize user input before inserting into DOM
            const safeQuery = sanitizeHTML(query);

            // Add user message to UI
            const history = document.getElementById('chatHistory');
            const userMsg = `
                <div class="flex justify-end animate-fade-in-up">
                    <div class="bg-cand-red text-white px-4 py-3 rounded-2xl rounded-tr-sm shadow-md max-w-[90%] text-sm">
                        ${safeQuery}
                    </div>
                </div>
            `;
            history.insertAdjacentHTML('beforeend', userMsg);
            input.value = '';

            // Scroll to bottom
            history.scrollTop = history.scrollHeight;

            // Simulate thinking
            const loadingMsg = `
                <div class="flex justify-start animate-fade-in-up" id="loadingBubble">
                    <div class="bg-white text-gray-500 border border-gray-200 px-4 py-3 rounded-2xl rounded-tl-sm shadow-sm">
                        <span class="flex items-center gap-1.5">
                            <span class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"></span>
                            <span class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></span>
                            <span class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></span>
                        </span>
                    </div>
                </div>
            `;
            history.insertAdjacentHTML('beforeend', loadingMsg);
            history.scrollTop = history.scrollHeight;

            // Redirect after 1s
            setTimeout(() => {
                // Open NotebookLM with security attributes
                window.open('https://notebooklm.google.com/notebook/03f2338f-f7f7-4adf-aba3-52b93672b484', '_blank', 'noopener,noreferrer');

                // Update UI to show system message
                const loadingBubble = document.getElementById('loadingBubble');
                if (loadingBubble) loadingBubble.remove();

                const systemMsg = `
                     <div class="flex justify-start animate-fade-in-up">
                          <div class="bg-blue-50 text-blue-800 border border-blue-100 px-4 py-3 rounded-2xl rounded-tl-sm shadow-sm max-w-[90%] text-sm">
                              <p class="font-bold flex items-center gap-2 mb-1">
                                <i data-lucide="external-link" class="w-4 h-4"></i>
                                Đã mở kết nối!
                              </p>
                              <p>Tôi đã chuyển câu hỏi của bạn sang hệ thống NotebookLM để xử lý chi tiết hơn. Vui lòng kiểm tra tab mới.</p>
                          </div>
                     </div>
                `;
                history.insertAdjacentHTML('beforeend', systemMsg);
                history.scrollTop = history.scrollHeight;
                lucide.createIcons(); // Re-render icons
            }, 1000);
        }


        function handleChatEnter(e) {
            if (e.key === 'Enter') handleChatSend();
        }

        function fillChat(text) {
            document.getElementById('fakeChatInput').value = text;
            handleChatSend();
        }
    </script>

    <script>
        // Visitor Statistics Logic
        // Visitor Statistics Logic (Real CounterAPI.dev)
        async function updateVisitorStats() {
            const NAMESPACE = 'tuyen-truyen-phap-luat-v1';
            const TOTAL_KEY = 'total-visits';
            const INITIAL_OFFSET = 2986; // Start from this number

            // Generate Today Key: YYYY-MM-DD
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const dateKey = `${year}-${month}-${day}`;
            const TODAY_KEY = `visits-${dateKey}`;

            // Helper to format with commas
            const fmt = (n) => n.toLocaleString();

            // LocalStorage keys for fallback
            const LS_TOTAL_KEY = 'visitor_total_count';
            const LS_TODAY_KEY = 'visitor_today_count';
            const LS_DATE_KEY = 'visitor_last_date';
            const LS_VISITED_KEY = 'visitor_session_counted';

            // Get stored values
            let storedTotal = parseInt(localStorage.getItem(LS_TOTAL_KEY) || '0');
            let storedToday = parseInt(localStorage.getItem(LS_TODAY_KEY) || '0');
            const storedDate = localStorage.getItem(LS_DATE_KEY);

            // Reset today count if it's a new day
            if (storedDate !== dateKey) {
                storedToday = 0;
                localStorage.setItem(LS_DATE_KEY, dateKey);
            }

            // Check if this session was already counted
            const sessionCounted = sessionStorage.getItem(LS_VISITED_KEY);

            // If not counted in this session, increment local counts
            if (!sessionCounted) {
                storedTotal++;
                storedToday++;
                localStorage.setItem(LS_TOTAL_KEY, storedTotal.toString());
                localStorage.setItem(LS_TODAY_KEY, storedToday.toString());
                sessionStorage.setItem(LS_VISITED_KEY, 'true');
            }

            try {
                // 1. Hit Total (Increment) - only if not counted in this session
                // Using counterapi.dev: returns { "count": 123, ... }
                const totalUrl = sessionCounted
                    ? `https://api.counterapi.dev/v1/${NAMESPACE}/${TOTAL_KEY}`
                    : `https://api.counterapi.dev/v1/${NAMESPACE}/${TOTAL_KEY}/up`;

                const totalRes = await fetch(totalUrl, {
                    method: 'GET',
                    mode: 'cors'
                });

                if (!totalRes.ok) throw new Error(`HTTP ${totalRes.status}`);

                const totalData = await totalRes.json();
                const totalCount = (totalData.count || 0) + INITIAL_OFFSET;
                document.getElementById('stat-total').innerText = fmt(totalCount);

                // Sync local storage with API value
                localStorage.setItem(LS_TOTAL_KEY, (totalData.count || 0).toString());

                // 2. Hit Today (Increment) - only if not counted in this session
                const todayUrl = sessionCounted
                    ? `https://api.counterapi.dev/v1/${NAMESPACE}/${TODAY_KEY}`
                    : `https://api.counterapi.dev/v1/${NAMESPACE}/${TODAY_KEY}/up`;

                const todayRes = await fetch(todayUrl, {
                    method: 'GET',
                    mode: 'cors'
                });

                if (!todayRes.ok) throw new Error(`HTTP ${todayRes.status}`);

                const todayData = await todayRes.json();
                document.getElementById('stat-today').innerText = fmt(todayData.count || 0);

                // Sync local storage with API value
                localStorage.setItem(LS_TODAY_KEY, (todayData.count || 0).toString());

            } catch (error) {
                console.error('API error, using local fallback:', error);
                // Use localStorage fallback values
                document.getElementById('stat-total').innerText = fmt(storedTotal + INITIAL_OFFSET);
                document.getElementById('stat-today').innerText = fmt(storedToday);
            }
        }

        // Call on load
        document.addEventListener('DOMContentLoaded', updateVisitorStats);
    </script>

    <script>
        // ========== KEYBOARD NAVIGATION (ACCESSIBILITY) ==========
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                // Close document modal
                const docModal = document.getElementById('docModal');
                if (docModal && !docModal.classList.contains('hidden')) {
                    docModal.classList.add('hidden');
                    document.body.style.overflow = '';
                }



                // Close mobile menu
                const mobileMenu = document.getElementById('mobileMenu');
                if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                }
            }
        });

        // Initialize Lucide icons after DOM is ready (since script is deferred)
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>

</body>

</html>